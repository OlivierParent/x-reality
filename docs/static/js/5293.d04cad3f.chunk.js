"use strict";(self.webpackChunkx_reality=self.webpackChunkx_reality||[]).push([[5293],{9363:(e,o,r)=>{let s;r.d(o,{n:()=>s}),function(e){let o=function(e){return e.playerJump="playerJump",e.playerMoveBackward="playerMoveBackward",e.playerMoveForward="playerMoveForward",e.playerMoveLeft="playerMoveLeft",e.playerMoveRight="playerMoveRight",e.playerRun="playerRun",e.pinballFlipperBoth="pinballFlipperBoth",e.pinballFlipperLeft="pinballFlipperLeft",e.pinballFlipperRight="pinballFlipperRight",e.pinballShoot="pinballShoot",e}({});const r="KeyA",s="KeyD",t="ArrowDown",n="KeyE",i="Enter",a="KeyF",l="KeyJ",c="ArrowLeft",p="KeyQ",I="ArrowRight",R="KeyS",E="Shift",T="Space",u="ArrowUp",L="KeyW",A="KeyZ",d=[{name:o.playerMoveBackward,keys:[t,s]},{name:o.playerMoveForward,keys:[u,n]},{name:o.playerMoveLeft,keys:[c,R]},{name:o.playerMoveRight,keys:[I,a]}],h=[{name:o.playerJump,keys:[T]},{name:o.playerRun,keys:[E]}],S=[{name:o.playerMoveBackward,keys:[t,R]},{name:o.playerMoveForward,keys:[u,L]},{name:o.playerMoveLeft,keys:[c,r]},{name:o.playerMoveRight,keys:[I,s]}],O=[{name:o.playerMoveBackward,keys:[t,R]},{name:o.playerMoveForward,keys:[u,A]},{name:o.playerMoveLeft,keys:[c,p]},{name:o.playerMoveRight,keys:[I,s]}];e.CONFIG_FIRST_PERSON_AZERTY=[...O,...h],e.CONFIG_FIRST_PERSON_UNIVERSAL=[...d,...h],e.CONFIG_FIRST_PERSON_QWERTY=[...S,...h],e.CONFIG_PINBALL_MACHINE=[{name:o.pinballFlipperBoth,keys:[T]},{name:o.pinballFlipperLeft,keys:[a]},{name:o.pinballFlipperRight,keys:[l]},{name:o.pinballShoot,keys:[i]}]}(s||(s={}))},3280:(e,o,r)=>{r.d(o,{p:()=>l});var s=r(4704),t=r(5397),n=r(9817);let i;var a;function l(){const{gravity:e,paused:o,showDebug:r}=(0,s.M4)(t.O.SCHEMA.PHYSICS,{gravity:i.gravity(),paused:i.paused(),showDebug:i.showDebug(!0)},n.F.folder(t.O.ORDER.PHYSICS));return{gravity:e,paused:o,showDebug:r}}(a=i||(i={})).gravity=function(){return{label:"Gravity",hint:"Default = 9.81",value:{x:arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,y:arguments.length>1&&void 0!==arguments[1]?arguments[1]:-9.80665,z:arguments.length>2&&void 0!==arguments[2]?arguments[2]:0}}},a.paused=function(){return{label:"Paused",hint:"Pause physics simulation.",value:arguments.length>0&&void 0!==arguments[0]&&arguments[0]}},a.showDebug=function(){return{label:"Debug",hint:"Show debug geometry.",value:arguments.length>0&&void 0!==arguments[0]&&arguments[0]}}},5198:(e,o,r)=>{let s;r.d(o,{r:()=>s}),function(e){let o=function(e){return e.BLACK_IRON="2D2D2A_74716E_8F8C8C_92958E",e.BUFFED_SILVER="54584E_B1BAC5_818B91_A7ACA3",e.GRAPHITE="2D2D2F_C6C2C5_727176_94949B",e.GREEN="54C104_BBFA0F_97EF04_7AE104",e.GREEN_CRYSTAL="2E763A_78A0B7_B3D1CF_14F209",e.SILVERY="4C4C4C_D2D2D2_8F8F8F_ACACAC",e.TITANIUM="C7C7D7_4C4E5A_818393_6C6C74",e.WORN_GOLD="6E5137_E8CA90_271912_B99C74",e}({});e.ID=o;let r=function(e){return e[e.XS=64]="XS",e[e.SM=128]="SM",e[e.MD=256]="MD",e[e.LG=512]="LG",e[e.XL=1024]="XL",e}({});e.SIZE=r}(s||(s={}))},5293:(e,o,r)=>{r.r(o),r.d(o,{default:()=>Ee});var s=r(9080),t=r(3082),n=r(4704),i=r(7313),a=r(5825);let l=function(e){return e[e.ATTRACTOR=0]="ATTRACTOR",e[e.BALL=1]="BALL",e[e.BUMPER=2]="BUMPER",e[e.CABINET=3]="CABINET",e[e.CONSTRAINT=4]="CONSTRAINT",e[e.FLIPPER=5]="FLIPPER",e[e.KICKER=6]="KICKER",e[e.PLAYFIELD=7]="PLAYFIELD",e[e.PLUNGER=8]="PLUNGER",e[e.SENSOR=9]="SENSOR",e[e.WALL=10]="WALL",e}({});const c=new class{constructor(){this._score=void 0,this._score=0}get score(){return this._score}set score(e){this._score=e}add(e){this._score+=Math.abs(e)}},p=(0,i.createContext)(c);var I=r(2952),R=r(2185),E=r(6417);const T=new a.Vector3(0,0,-5),u=.6,L={HEIGHT:8,WIDTH:8},A=e=>(0,E.jsxs)("group",{name:"Attractor",...e,children:[(0,E.jsx)(R.h,{collisionGroups:(0,t.bI)(l.ATTRACTOR,[l.BALL]),position:T,range:.05,strength:.01,type:"linear"}),(0,E.jsx)(I.aL,{args:[u,L.WIDTH,L.HEIGHT],position:T,children:(0,E.jsx)("meshBasicMaterial",{color:16711935,opacity:.5,transparent:!0})})]});var d=r(124);const h={CENTER:.001,EXTREMITY:1},S=7,O=-10,x={LEFT:{COLOR:"hsl(0, 100%, 75%)",POSITION:new a.Vector3(-h.EXTREMITY*(Math.random()+.5),S,O)},MIDDLE:{COLOR:"hsl(120, 100%, 75%)",POSITION:new a.Vector3(h.CENTER*(2*Math.random()-1),S,O-.5)},PHYSICS:{MASS:1,FRICTION:.1,RESTITUTION:0},RADIUS:.125,RIGHT:{COLOR:"hsl(240, 100%, 75%)",POSITION:new a.Vector3(h.EXTREMITY*(Math.random()+.5),S,O)}};var N=r(5198);const m=(0,i.forwardRef)(((e,o)=>{const{color:r=16777215,position:s,radius:n=.125}=e,[i]=(0,d.K)(N.r.ID.TITANIUM,N.r.SIZE.XL);return(0,E.jsx)(t.ib,{canSleep:!1,ccd:!0,colliders:"ball",collisionGroups:(0,t.bI)(l.BALL,[l.ATTRACTOR,l.BALL,l.BUMPER,l.FLIPPER,l.KICKER,l.PLAYFIELD,l.PLUNGER,l.SENSOR,l.WALL]),friction:x.PHYSICS.FRICTION,mass:x.PHYSICS.MASS,position:s,ref:o,restitution:x.PHYSICS.RESTITUTION,solverGroups:(0,t.bI)(l.BALL,[l.ATTRACTOR,l.BALL,l.BUMPER,l.FLIPPER,l.KICKER,l.PLAYFIELD,l.PLUNGER,l.WALL]),type:"dynamic",children:(0,E.jsx)(I.aL,{args:[n],children:(0,E.jsx)("meshMatcapMaterial",{color:r,matcap:i})})})})),M={ACTIVE:"green",INACTIVE:"yellow"},y=.25,C={RESTITUTION:2},f={BOTTOM:.1,TOP:.2},g=new a.Vector3(0,y/2,0),P=e=>{const{position:o=new a.Vector3(0,0,0)}=e,r=(0,i.useRef)(null);return(0,E.jsx)("group",{name:"Bumper",position:o,children:(0,E.jsxs)(t.ib,{colliders:!1,position:g,restitution:C.RESTITUTION,type:"fixed",children:[(0,E.jsx)(t.Y_,{args:[y/2,(f.BOTTOM+f.TOP)/2],onCollisionEnter:()=>{r.current.color.set(M.ACTIVE)},onCollisionExit:()=>{setTimeout((()=>{r.current.color.set(M.INACTIVE)}),500)},collisionGroups:(0,t.bI)(l.BUMPER,l.BALL),solverGroups:(0,t.bI)(l.BUMPER,l.BALL)}),(0,E.jsx)(I.Ab,{args:[f.TOP,f.BOTTOM,y],children:(0,E.jsx)("meshBasicMaterial",{color:M.INACTIVE,opacity:.5,ref:r,transparent:!0})})]})})},j=.25,b=.3,D=new a.MeshBasicMaterial,w=new a.MeshBasicMaterial,G=new a.MeshBasicMaterial;D.color.setHSL(0,1,.5),w.color.setHSL(2/3,1,.5),G.color.setHSL(1/3,1,.5);const F=e=>(0,E.jsx)("group",{name:"Cabinet Walls",...e,children:(0,E.jsxs)(t.ib,{collisionGroups:(0,t.bI)(l.WALL,[l.BALL]),restitution:.25,friction:.5,solverGroups:(0,t.bI)(l.WALL,[l.BALL]),type:"fixed",children:[(0,E.jsx)(I.xu,{args:[10,b,j],material:w,name:"Side Wall Top",position:new a.Vector3(0,b/2,-14)}),(0,E.jsx)(I.xu,{args:[16,b,j],material:D,name:"Side Wall Left",position:new a.Vector3(-5,b/2,-6),rotation:[0,Math.PI/2,0]}),(0,E.jsx)(I.xu,{args:[16,b,j],material:G,name:"Side Wall Right",position:new a.Vector3(5,b/2,-6),rotation:[0,-Math.PI/2,0]}),(0,E.jsx)(I.xu,{args:[3.5,b,j],material:D,name:"Side Wall Bottom Left",position:new a.Vector3(-2.6,b/2,-.6),rotation:[0,-Math.PI/9,0]}),(0,E.jsx)(I.xu,{args:[3.5,b,j],material:G,name:"Side Wall Bottom Right",position:new a.Vector3(2.6,b/2,-.6),rotation:[0,Math.PI/9,0]})]})});var B=r(9782);const v=.25,H=new a.Vector3(0,0,.01);var _=function(e){return e[e.RED=16711680]="RED",e[e.GREEN=65280]="GREEN",e[e.BLUE=255]="BLUE",e}(_||{});const U=e=>{const{orientation:o,position:r=new a.Vector3(0,0,0)}=e,n=(0,B.Z)((e=>e.pinballFlipperBoth)),c=(0,B.Z)((e=>e.pinballFlipperLeft)),p=(0,B.Z)((e=>e.pinballFlipperRight)),R="left"===o,T=n||(R?c:p),u=T?_.BLUE:R?_.RED:_.GREEN,L=a.MathUtils.degToRad(40*(R?-1:1)),A=.8*(R?1:-1),d=(0,i.useRef)(null),h=(0,i.useRef)(null),S=(0,i.useRef)(null),O=[[0,0,0],[0,0,0],[0,1,0]];(0,t.UP)(h,S,O);const x=(0,i.useMemo)((()=>new a.Vector3(A+10*(R?-1:1),.25,.3)),[R,A]);return(0,s.C)(((e,o)=>{T&&h.current.applyImpulseAtPoint(H,x,!0)})),(0,E.jsxs)("group",{name:"Flipper Assembly",position:r,children:[(0,E.jsx)(t.ib,{canSleep:!1,ccd:!0,colliders:"cuboid",collisionGroups:(0,t.bI)(l.FLIPPER,[l.BALL,l.CONSTRAINT]),mass:1,name:"Flipper",ref:h,restitution:2,rotation:new a.Euler(0,L,0),type:"dynamic",solverGroups:(0,t.bI)(l.FLIPPER,[l.BALL,l.CONSTRAINT]),children:(0,E.jsxs)("mesh",{ref:d,position:new a.Vector3(A/2,.225,0),children:[(0,E.jsx)("boxGeometry",{args:[1,.25,.3]}),(0,E.jsx)("meshStandardMaterial",{color:u,transparent:!1})]})}),(0,E.jsx)(t.ib,{name:"Fixation",ref:S,type:"fixed",children:(0,E.jsx)(I.xu,{args:[.0625,.0625,.0625]})}),(0,E.jsxs)(t.ib,{name:"Flipper Constraints",type:"fixed",children:[(0,E.jsx)(t.dp,{args:[.1],collisionGroups:(0,t.bI)(l.CONSTRAINT),name:"Flipper Constraint Upper",position:[(.8-.1)*(R?1:-1),.225,0],restitution:-999}),(0,E.jsx)(t.dp,{args:[.1],collisionGroups:(0,t.bI)(l.CONSTRAINT),name:"Flipper Constraint Lower",position:[(.8-.5)*(R?1:-1),.225,.7],restitution:-999})]}),(0,E.jsx)(I.aL,{name:"Impulse point visualisation",args:[v,4,4],position:x,children:(0,E.jsx)("meshBasicMaterial",{color:_.BLUE,wireframe:!0})})]})},V={LEFT:{COLOR:"hsl(0, 100%, 75%)",ORIENTATION:"left",POSITION:new a.Vector3(-1,0,0)},RIGHT:{COLOR:"hsl(240, 100%, 75%)",ORIENTATION:"right",POSITION:new a.Vector3(1,0,0)}},k={WIDTH:10,HEIGHT:16,THICKNESS:.125,COLLIDER:{WIDTH:5,HEIGHT:.0625,DEPTH:8}},W=new a.Vector3(0,0,-6),K=new a.Euler(a.MathUtils.degToRad(-90),0,0),Y=()=>(0,E.jsxs)(t.ib,{ccd:!0,type:"fixed",children:[(0,E.jsx)(I.JO,{args:[k.WIDTH,k.HEIGHT],rotation:K,position:W}),(0,E.jsx)(t.jc,{args:[k.COLLIDER.WIDTH,k.COLLIDER.HEIGHT,k.COLLIDER.DEPTH],collisionGroups:(0,t.bI)(l.PLAYFIELD,[l.BALL]),friction:.25,position:W,restitution:.25,solverGroups:(0,t.bI)(l.PLAYFIELD,[l.BALL])})]}),X=30*x.RADIUS,Z={PLUNGER:{RADIUS:x.RADIUS/2,LENGTH:X},RAIL:{LENGTH:2*X/3,DIAMETER:2*x.RADIUS}},J=e=>{const[o]=(0,d.K)(N.r.ID.TITANIUM,N.r.SIZE.XL),r=(0,B.Z)((e=>e.pinballShoot)),s=(0,i.useRef)(null),n=(0,i.useRef)(null);return(0,t.RU)(n,s,[[0,0,0],[0,0,0],[0,0,-1],[0,.8]]),(0,i.useEffect)((()=>{n.current.addForce(new a.Vector3(0,0,10),!0)}),[]),(0,i.useEffect)((()=>{console.info("shootOn:",r),r&&n.current.applyImpulse({x:0,y:0,z:-20},!0)}),[r]),(0,E.jsxs)("group",{...e,children:[(0,E.jsxs)(t.ib,{canSleep:!1,ccd:!0,colliders:!1,friction:0,mass:10,name:"Plunger",ref:n,restitution:0,type:"dynamic",children:[(0,E.jsx)(t.jc,{args:[x.RADIUS,x.RADIUS,Z.PLUNGER.LENGTH/2],collisionGroups:(0,t.bI)(l.PLUNGER,[l.BALL]),mass:1,solverGroups:(0,t.bI)(l.PLUNGER,[l.BALL])}),(0,E.jsx)(I.Ab,{args:[Z.PLUNGER.RADIUS,Z.PLUNGER.RADIUS,Z.PLUNGER.LENGTH,32],rotation:new a.Euler(Math.PI/2,0,0),children:(0,E.jsx)("meshMatcapMaterial",{color:r?"blue":"white",matcap:o})})]}),(0,E.jsx)(t.ib,{canSleep:!1,ccd:!0,colliders:!1,collisionGroups:(0,t.bI)(l.CONSTRAINT,[l.PLUNGER]),name:"Plunger Constraint",position:[0,.1,0],ref:s,solverGroups:(0,t.bI)(l.CONSTRAINT,[l.PLUNGER]),type:"fixed",children:(0,E.jsx)(t.jc,{args:[.1,.1,.1]})})]})},z=e=>{const[o]=(0,d.K)(N.r.ID.TITANIUM,N.r.SIZE.XL),{position:r}=e;return(0,E.jsxs)("group",{name:"Plunger Assembly",position:r,children:[(0,E.jsxs)(t.ib,{collisionGroups:(0,t.bI)(l.WALL,[l.BALL]),name:"Wall",solverGroups:(0,t.bI)(l.WALL,[l.BALL]),type:"fixed",children:[(0,E.jsx)(I.xu,{args:[Z.RAIL.DIAMETER,Z.RAIL.DIAMETER,Z.RAIL.LENGTH],position:[-(Z.RAIL.DIAMETER+.01),Z.RAIL.DIAMETER/2,0],children:(0,E.jsx)("meshMatcapMaterial",{matcap:o})}),(0,E.jsx)(I.xu,{args:[Z.RAIL.DIAMETER,Z.RAIL.DIAMETER,Z.RAIL.LENGTH],position:[Z.RAIL.DIAMETER+.01,Z.RAIL.DIAMETER/2,0],children:(0,E.jsx)("meshMatcapMaterial",{matcap:o})})]}),(0,E.jsx)(J,{position:new a.Vector3(0,.1,0)})]})};var Q=r(5397),q=function(e){return e.RESET="Reset",e.RESTORE_SNAPSHOT="Restore Snapshot",e.STORE_SNAPSHOT="Store Snapshot",e}(q||{});const $={POSITION:new a.Vector3(0,3,5),TARGET:new a.Vector3(0,0,-2)},ee=new a.Quaternion,oe=new a.Vector3;function re(e,o){e.current.setAngvel(oe,!0),e.current.setLinvel(oe,!0),e.current.setRotation(ee,!0),e.current.setTranslation(o,!0)}const se=new a.Euler(a.MathUtils.degToRad(20),0,0),te=e=>{const o={[q.STORE_SNAPSHOT]:(0,n.LI)((()=>y())),[q.RESTORE_SNAPSHOT]:(0,n.LI)((()=>M())),[q.RESET]:(0,n.LI)((()=>N()))};var r;r=o,(0,n.M4)(Q.O.SCHEMA.SIMULATION,r,{order:Q.O.ORDER.SIMULATION});const c=(0,i.useContext)(p),I=(0,t.dv)(),{camera:R}=(0,s.A)(),T=(0,i.useRef)(null),u=(0,i.useRef)(null),L=(0,i.useRef)(null),d=(0,i.useRef)(null),[S,O]=(0,i.useState)(0),N=(0,i.useCallback)((()=>{console.info("Rapier: resetting..."),x.LEFT.POSITION.setX(-h.EXTREMITY*(Math.random()+.5)),x.MIDDLE.POSITION.setX(h.CENTER*(2*Math.random()-1)),x.RIGHT.POSITION.setX(h.EXTREMITY*(Math.random()+.5)),re(T,x.LEFT.POSITION),re(u,x.MIDDLE.POSITION),re(L,x.RIGHT.POSITION)}),[]),M=(0,i.useCallback)((()=>{console.info("Rapier: restoring snapshot...");const e=I.rapier.World.restoreSnapshot(d.current);I.setWorld(e)}),[I]),y=(0,i.useCallback)((()=>{console.info("Rapier: taking snapshot...");const e=I.world.takeSnapshot();d.current=e}),[I]);return(0,i.useEffect)((()=>{R.position.set(...$.POSITION.toArray()),R.lookAt(...$.TARGET.toArray())}),[R]),(0,i.useEffect)((()=>{console.info("Rapier: counter",S),3<=S&&(setTimeout((()=>{console.info("Rapier: calling reset."),N()}),2e3),O(0))}),[S,N]),(0,i.useEffect)((()=>{setTimeout((()=>{y()}),250)}),[y]),(0,s.C)(((e,o)=>{c.add(Math.floor(2*Math.random()))})),(0,E.jsxs)("group",{name:"Pinball Machine Game",...e,children:[(0,E.jsxs)("group",{name:"Tilt",rotation:se,children:[(0,E.jsxs)("group",{name:"Cabinet",children:[(0,E.jsx)(Y,{}),(0,E.jsx)(F,{}),(0,E.jsx)(t.ib,{type:"fixed",children:(0,E.jsx)(t.jc,{args:[4.7,.125,.125],collisionGroups:(0,t.bI)(l.SENSOR,[l.BALL]),onCollisionExit:()=>{console.info("Rapier: collision detected!"),O((e=>e+1))},position:new a.Vector3(0,.125,2),sensor:!0})})]}),(0,E.jsx)("group",{name:"Attractor",children:(0,E.jsx)(A,{})}),(0,E.jsxs)("group",{name:"Bumpers",children:[(0,E.jsx)(P,{position:new a.Vector3(0,0,-2)}),(0,E.jsx)(P,{position:new a.Vector3(-3,0,-5)}),(0,E.jsx)(P,{position:new a.Vector3(3,0,-5)})]}),(0,E.jsx)("group",{name:"Flippers",children:(0,E.jsxs)("group",{position:new a.Vector3(0,0,0),children:[(0,E.jsx)(U,{orientation:V.LEFT.ORIENTATION,position:V.LEFT.POSITION}),(0,E.jsx)(U,{orientation:V.RIGHT.ORIENTATION,position:V.RIGHT.POSITION})]})}),(0,E.jsxs)("group",{name:"Plunger Assembly",position:[4.7,0,2],children:[(0,E.jsx)(A,{position:new a.Vector3(0,0,0)}),(0,E.jsx)(m,{color:"cyan",position:new a.Vector3(0,3,-5)}),(0,E.jsx)(z,{position:new a.Vector3(0,0,0)})]})]}),(0,E.jsxs)("group",{name:"Balls",children:[(0,E.jsx)(m,{color:x.LEFT.COLOR,position:x.LEFT.POSITION,ref:T}),(0,E.jsx)(m,{color:x.MIDDLE.COLOR,position:x.MIDDLE.POSITION,ref:u}),(0,E.jsx)(m,{color:x.RIGHT.COLOR,position:x.RIGHT.POSITION,ref:L})]})]})};var ne=r(7066),ie=r(5819),ae=r(1724),le=r(7862),ce=r(9363),pe=r(4662),Ie=r(3280);const Re=e=>{let{children:o}=e;const r=(0,pe.p)(),s=(0,Ie.p)();return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsxs)(ie.Xz,{camera:void 0,flat:r.flat,frameloop:r.frameloop,linear:r.linear,orthographic:!1,shadows:r.shadows,children:[!1,(0,E.jsxs)(i.Suspense,{children:[(0,E.jsx)(ae.Z,{}),(0,E.jsx)(le.u,{}),(0,E.jsx)(B.c,{map:ce.n.CONFIG_PINBALL_MACHINE,children:(0,E.jsx)(t.wI,{colliders:void 0,debug:s.showDebug,gravity:[s.gravity.x,s.gravity.y,s.gravity.z],paused:s.paused,timeStep:"vary",updatePriority:void 0,children:o})})]})]}),(0,E.jsx)(n.Zf,{collapsed:!1,fill:!1,flat:!1,hidden:!1,oneLineLabels:!0,titleBar:!0}),(0,E.jsx)(ne.a,{})]})},Ee=e=>(0,E.jsx)(Re,{children:(0,E.jsx)(te,{...e})})}}]);