"use strict";(self.webpackChunkx_reality=self.webpackChunkx_reality||[]).push([[8542],{9363:(e,o,r)=>{let t;r.d(o,{n:()=>t}),function(e){let o=function(e){return e.playerJump="playerJump",e.playerMoveBackward="playerMoveBackward",e.playerMoveForward="playerMoveForward",e.playerMoveLeft="playerMoveLeft",e.playerMoveRight="playerMoveRight",e.playerRun="playerRun",e.pinballFlipperBoth="pinballFlipperBoth",e.pinballFlipperLeft="pinballFlipperLeft",e.pinballFlipperRight="pinballFlipperRight",e.pinballShoot="pinballShoot",e}({}),r=function(e){return e.A="KeyA",e.D="KeyD",e.DOWN="ArrowDown",e.E="KeyE",e.F="KeyF",e.J="KeyJ",e.LEFT="ArrowLeft",e.Q="KeyQ",e.ENTER="Enter",e.RIGHT="ArrowRight",e.S="KeyS",e.SHIFT="Shift",e.SPACE="Space",e.UP="ArrowUp",e.W="KeyW",e.Z="KeyZ",e}({});const t=[{name:o.playerMoveBackward,keys:[r.DOWN,r.D]},{name:o.playerMoveForward,keys:[r.UP,r.E]},{name:o.playerMoveLeft,keys:[r.LEFT,r.S]},{name:o.playerMoveRight,keys:[r.RIGHT,r.F]}],s=[{name:o.playerJump,keys:[r.SPACE]},{name:o.playerRun,keys:[r.SHIFT]}],n=[{name:o.playerMoveBackward,keys:[r.DOWN,r.S]},{name:o.playerMoveForward,keys:[r.UP,r.W]},{name:o.playerMoveLeft,keys:[r.LEFT,r.A]},{name:o.playerMoveRight,keys:[r.RIGHT,r.D]}],i=[{name:o.playerMoveBackward,keys:[r.DOWN,r.S]},{name:o.playerMoveForward,keys:[r.UP,r.Z]},{name:o.playerMoveLeft,keys:[r.LEFT,r.Q]},{name:o.playerMoveRight,keys:[r.RIGHT,r.D]}];e.CONFIG_FIRST_PERSON_AZERTY=[...i,...s],e.CONFIG_FIRST_PERSON_UNIVERSAL=[...t,...s],e.CONFIG_FIRST_PERSON_QWERTY=[...n,...s],e.CONFIG_PINBALL_MACHINE=[{name:o.pinballFlipperBoth,keys:[r.SPACE]},{name:o.pinballFlipperLeft,keys:[r.F]},{name:o.pinballFlipperRight,keys:[r.J]},{name:o.pinballShoot,keys:[r.ENTER]}]}(t||(t={}))},3280:(e,o,r)=>{r.d(o,{p:()=>l});var t=r(4704),s=r(5397),n=r(9817);let i;var a;function l(){const{gravity:e,paused:o,showDebug:r}=(0,t.M4)(s.O.SCHEMA.PHYSICS,{gravity:i.gravity(),paused:i.paused(),showDebug:i.showDebug(!0)},n.F.folder(s.O.ORDER.PHYSICS));return{gravity:e,paused:o,showDebug:r}}(a=i||(i={})).gravity=function(){return{label:"Gravity",hint:"Default = 9.81",value:{x:arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,y:arguments.length>1&&void 0!==arguments[1]?arguments[1]:-9.80665,z:arguments.length>2&&void 0!==arguments[2]?arguments[2]:0}}},a.paused=function(){return{label:"Paused",hint:"Pause physics simulation.",value:arguments.length>0&&void 0!==arguments[0]&&arguments[0]}},a.showDebug=function(){return{label:"Debug",hint:"Show debug geometry.",value:arguments.length>0&&void 0!==arguments[0]&&arguments[0]}}},5198:(e,o,r)=>{let t;r.d(o,{r:()=>t}),function(e){let o=function(e){return e.BLACK_IRON="2D2D2A_74716E_8F8C8C_92958E",e.BUFFED_SILVER="54584E_B1BAC5_818B91_A7ACA3",e.GRAPHITE="2D2D2F_C6C2C5_727176_94949B",e.GREEN="54C104_BBFA0F_97EF04_7AE104",e.GREEN_CRYSTAL="2E763A_78A0B7_B3D1CF_14F209",e.SILVERY="4C4C4C_D2D2D2_8F8F8F_ACACAC",e.TITANIUM="C7C7D7_4C4E5A_818393_6C6C74",e.WORN_GOLD="6E5137_E8CA90_271912_B99C74",e}({});e.ID=o;let r=function(e){return e[e.XS=64]="XS",e[e.SM=128]="SM",e[e.MD=256]="MD",e[e.LG=512]="LG",e[e.XL=1024]="XL",e}({});e.SIZE=r}(t||(t={}))},8542:(e,o,r)=>{r.r(o),r.d(o,{default:()=>Re});var t=r(3002),s=r(3082),n=r(4704),i=r(7313),a=r(5825);let l=function(e){return e[e.ATTRACTOR=0]="ATTRACTOR",e[e.BALL=1]="BALL",e[e.BUMPER=2]="BUMPER",e[e.CABINET=3]="CABINET",e[e.CONSTRAINT=4]="CONSTRAINT",e[e.FLIPPER=5]="FLIPPER",e[e.KICKER=6]="KICKER",e[e.PLAYFIELD=7]="PLAYFIELD",e[e.PLUNGER=8]="PLUNGER",e[e.SENSOR=9]="SENSOR",e[e.WALL=10]="WALL",e}({});const c=new class{constructor(){this._score=void 0,this._score=0}get score(){return this._score}set score(e){this._score=e}add(e){this._score+=Math.abs(e)}},p=(0,i.createContext)(c);var I=r(2952),E=r(2185),R=r(6417);const u=new a.Vector3(0,0,-5),T=.6,L={HEIGHT:8,WIDTH:8},A=e=>(0,R.jsxs)("group",{name:"Attractor",...e,children:[(0,R.jsx)(E.h,{collisionGroups:(0,s.bI)(l.ATTRACTOR,[l.BALL]),position:u,range:.05,strength:.01,type:"linear"}),(0,R.jsx)(I.aL,{args:[T,L.WIDTH,L.HEIGHT],position:u,children:(0,R.jsx)("meshBasicMaterial",{color:16711935,opacity:.5,transparent:!0})})]});var d=r(124),h=r(5198);const S=(0,i.forwardRef)(((e,o)=>{const{color:r=16777215,position:t,radius:n=.125}=e,[i]=(0,d.K)(h.r.ID.TITANIUM,h.r.SIZE.XL);return(0,R.jsx)(s.ib,{canSleep:!1,ccd:!0,colliders:"ball",collisionGroups:(0,s.bI)(l.BALL,[l.ATTRACTOR,l.BALL,l.BUMPER,l.FLIPPER,l.KICKER,l.PLAYFIELD,l.PLUNGER,l.SENSOR,l.WALL]),friction:.1,mass:1,position:t,ref:o,restitution:0,solverGroups:(0,s.bI)(l.BALL,[l.ATTRACTOR,l.BALL,l.BUMPER,l.FLIPPER,l.KICKER,l.PLAYFIELD,l.PLUNGER,l.WALL]),type:"dynamic",children:(0,R.jsx)(I.aL,{args:[n],children:(0,R.jsx)("meshMatcapMaterial",{color:r,matcap:i})})})})),O={CENTER:.001,EXTREMITY:1},x=7,N=-10,m={LEFT:{COLOR:"hsl(0, 100%, 75%)",POSITION:new a.Vector3(-O.EXTREMITY*(Math.random()+.5),x,N)},MIDDLE:{COLOR:"hsl(120, 100%, 75%)",POSITION:new a.Vector3(O.CENTER*(2*Math.random()-1),x,N-.5)},RADIUS:.125,RIGHT:{COLOR:"hsl(240, 100%, 75%)",POSITION:new a.Vector3(O.EXTREMITY*(Math.random()+.5),x,N)}},M={ACTIVE:"green",INACTIVE:"yellow"},y=.25,f={BOTTOM:.1,TOP:.2},P=e=>{const{position:o=new a.Vector3(0,0,0)}=e,r=(0,i.useRef)(null);return(0,R.jsx)("group",{name:"Bumper",position:o,children:(0,R.jsxs)(s.ib,{colliders:!1,position:new a.Vector3(0,y/2,0),restitution:2,type:"fixed",children:[(0,R.jsx)(s.Y_,{args:[y/2,(f.BOTTOM+f.TOP)/2],onCollisionEnter:()=>{r.current.color.set(M.ACTIVE)},onCollisionExit:()=>{setTimeout((()=>{r.current.color.set(M.INACTIVE)}),500)},collisionGroups:(0,s.bI)(l.BUMPER,l.BALL),solverGroups:(0,s.bI)(l.BUMPER,l.BALL)}),(0,R.jsx)(I.Ab,{args:[f.TOP,f.BOTTOM,y],children:(0,R.jsx)("meshBasicMaterial",{color:M.INACTIVE,opacity:.5,ref:r,transparent:!0})})]})})},g=.25,C=.3,j=new a.MeshBasicMaterial,D=new a.MeshBasicMaterial,b=new a.MeshBasicMaterial;j.color.setHSL(0,1,.5),D.color.setHSL(2/3,1,.5),b.color.setHSL(1/3,1,.5);const F=e=>(0,R.jsx)("group",{name:"Cabinet Walls",...e,children:(0,R.jsxs)(s.ib,{collisionGroups:(0,s.bI)(l.WALL,[l.BALL]),restitution:.25,friction:.5,solverGroups:(0,s.bI)(l.WALL,[l.BALL]),type:"fixed",children:[(0,R.jsx)(I.xu,{args:[10,C,g],material:D,name:"Side Wall Top",position:new a.Vector3(0,C/2,-14)}),(0,R.jsx)(I.xu,{args:[16,C,g],material:j,name:"Side Wall Left",position:new a.Vector3(-5,C/2,-6),rotation:[0,Math.PI/2,0]}),(0,R.jsx)(I.xu,{args:[16,C,g],material:b,name:"Side Wall Right",position:new a.Vector3(5,C/2,-6),rotation:[0,-Math.PI/2,0]}),(0,R.jsx)(I.xu,{args:[3.5,C,g],material:j,name:"Side Wall Bottom Left",position:new a.Vector3(-2.6,C/2,-.6),rotation:[0,-Math.PI/9,0]}),(0,R.jsx)(I.xu,{args:[3.5,C,g],material:b,name:"Side Wall Bottom Right",position:new a.Vector3(2.6,C/2,-.6),rotation:[0,Math.PI/9,0]})]})});var G=r(9782);const w=.25,B=new a.Vector3(0,0,.01);var v=function(e){return e[e.RED=16711680]="RED",e[e.GREEN=65280]="GREEN",e[e.BLUE=255]="BLUE",e}(v||{});const _=e=>{const{orientation:o,position:r=new a.Vector3(0,0,0)}=e,n=(0,G.Z)((e=>e.pinballFlipperBoth)),c=(0,G.Z)((e=>e.pinballFlipperLeft)),p=(0,G.Z)((e=>e.pinballFlipperRight)),E="left"===o,u=n||(E?c:p),T=u?v.BLUE:E?v.RED:v.GREEN,L=a.MathUtils.degToRad(40*(E?-1:1)),A=.8*(E?1:-1),d=(0,i.useRef)(null),h=(0,i.useRef)(null),S=(0,i.useRef)(null),O=[[0,0,0],[0,0,0],[0,1,0]];(0,s.UP)(h,S,O);const x=(0,i.useMemo)((()=>new a.Vector3(A+10*(E?-1:1),.25,.3)),[E,A]);return(0,t.C)(((e,o)=>{u&&h.current.applyImpulseAtPoint(B,x,!0)})),(0,R.jsxs)("group",{name:"Flipper Assembly",position:r,children:[(0,R.jsx)(s.ib,{canSleep:!1,ccd:!0,colliders:"cuboid",collisionGroups:(0,s.bI)(l.FLIPPER,[l.BALL,l.CONSTRAINT]),mass:1,name:"Flipper",ref:h,restitution:2,rotation:new a.Euler(0,L,0),type:"dynamic",solverGroups:(0,s.bI)(l.FLIPPER,[l.BALL,l.CONSTRAINT]),children:(0,R.jsxs)("mesh",{ref:d,position:new a.Vector3(A/2,.225,0),children:[(0,R.jsx)("boxGeometry",{args:[1,.25,.3]}),(0,R.jsx)("meshStandardMaterial",{color:T,transparent:!1})]})}),(0,R.jsx)(s.ib,{name:"Fixation",ref:S,type:"fixed",children:(0,R.jsx)(I.xu,{args:[.0625,.0625,.0625]})}),(0,R.jsxs)(s.ib,{name:"Flipper Constraints",type:"fixed",children:[(0,R.jsx)(s.dp,{args:[.1],collisionGroups:(0,s.bI)(l.CONSTRAINT),name:"Flipper Constraint Upper",position:[(.8-.1)*(E?1:-1),.225,0],restitution:-999}),(0,R.jsx)(s.dp,{args:[.1],collisionGroups:(0,s.bI)(l.CONSTRAINT),name:"Flipper Constraint Lower",position:[(.8-.5)*(E?1:-1),.225,.7],restitution:-999})]}),(0,R.jsx)(I.aL,{name:"Impulse point visualisation",args:[w,4,4],position:x,children:(0,R.jsx)("meshBasicMaterial",{color:v.BLUE,wireframe:!0})})]})},U={LEFT:{COLOR:"hsl(0, 100%, 75%)",ORIENTATION:"left",POSITION:new a.Vector3(-1,0,0)},RIGHT:{COLOR:"hsl(240, 100%, 75%)",ORIENTATION:"right",POSITION:new a.Vector3(1,0,0)}},H=10,V=16,k={WIDTH:H/2,HEIGHT:.125/2,DEPTH:V/2},W=new a.Vector3(0,0,-6),K=new a.Euler(a.MathUtils.degToRad(-90),0,0),Y=()=>(0,R.jsxs)(s.ib,{ccd:!0,type:"fixed",children:[(0,R.jsx)(I.JO,{args:[H,V],rotation:K,position:W}),(0,R.jsx)(s.jc,{args:[k.WIDTH,k.HEIGHT,k.DEPTH],collisionGroups:(0,s.bI)(l.PLAYFIELD,[l.BALL]),friction:.25,position:W,restitution:.25,solverGroups:(0,s.bI)(l.PLAYFIELD,[l.BALL])})]}),X=30*m.RADIUS,Z={PLUNGER:{RADIUS:m.RADIUS/2,LENGTH:X},RAIL:{LENGTH:2*X/3,DIAMETER:2*m.RADIUS}},J=e=>{const[o]=(0,d.K)(h.r.ID.TITANIUM,h.r.SIZE.XL),r=(0,G.Z)((e=>e.pinballShoot)),t=(0,i.useRef)(null),n=(0,i.useRef)(null);return(0,s.RU)(n,t,[[0,0,0],[0,0,0],[0,0,-1],[0,.8]]),(0,i.useEffect)((()=>{n.current.addForce(new a.Vector3(0,0,10),!0)}),[]),(0,i.useEffect)((()=>{console.info("shootOn:",r),r&&n.current.applyImpulse({x:0,y:0,z:-20},!0)}),[r]),(0,R.jsxs)("group",{...e,children:[(0,R.jsxs)(s.ib,{canSleep:!1,ccd:!0,colliders:!1,friction:0,mass:10,name:"Plunger",ref:n,restitution:0,type:"dynamic",children:[(0,R.jsx)(s.jc,{args:[m.RADIUS,m.RADIUS,Z.PLUNGER.LENGTH/2],collisionGroups:(0,s.bI)(l.PLUNGER,[l.BALL]),mass:1,solverGroups:(0,s.bI)(l.PLUNGER,[l.BALL])}),(0,R.jsx)(I.Ab,{args:[Z.PLUNGER.RADIUS,Z.PLUNGER.RADIUS,Z.PLUNGER.LENGTH,32],rotation:new a.Euler(Math.PI/2,0,0),children:(0,R.jsx)("meshMatcapMaterial",{color:r?"blue":"white",matcap:o})})]}),(0,R.jsx)(s.ib,{canSleep:!1,ccd:!0,colliders:!1,collisionGroups:(0,s.bI)(l.CONSTRAINT,[l.PLUNGER]),name:"Plunger Constraint",position:[0,.1,0],ref:t,solverGroups:(0,s.bI)(l.CONSTRAINT,[l.PLUNGER]),type:"fixed",children:(0,R.jsx)(s.jc,{args:[.1,.1,.1]})})]})},Q=e=>{const[o]=(0,d.K)(h.r.ID.TITANIUM,h.r.SIZE.XL),{position:r}=e;return(0,R.jsxs)("group",{name:"Plunger Assembly",position:r,children:[(0,R.jsxs)(s.ib,{collisionGroups:(0,s.bI)(l.WALL,[l.BALL]),name:"Wall",solverGroups:(0,s.bI)(l.WALL,[l.BALL]),type:"fixed",children:[(0,R.jsx)(I.xu,{args:[Z.RAIL.DIAMETER,Z.RAIL.DIAMETER,Z.RAIL.LENGTH],position:[-(Z.RAIL.DIAMETER+.01),Z.RAIL.DIAMETER/2,0],children:(0,R.jsx)("meshMatcapMaterial",{matcap:o})}),(0,R.jsx)(I.xu,{args:[Z.RAIL.DIAMETER,Z.RAIL.DIAMETER,Z.RAIL.LENGTH],position:[Z.RAIL.DIAMETER+.01,Z.RAIL.DIAMETER/2,0],children:(0,R.jsx)("meshMatcapMaterial",{matcap:o})})]}),(0,R.jsx)(J,{position:new a.Vector3(0,.1,0)})]})};var z=r(5397),q=function(e){return e.RESET="Reset",e.RESTORE_SNAPSHOT="Restore Snapshot",e.STORE_SNAPSHOT="Store Snapshot",e}(q||{});const $={POSITION:new a.Vector3(0,3,5),TARGET:new a.Vector3(0,0,-2)},ee=new a.Quaternion,oe=new a.Vector3;function re(e,o){e.current.setAngvel(oe,!0),e.current.setLinvel(oe,!0),e.current.setRotation(ee,!0),e.current.setTranslation(o,!0)}const te=new a.Euler(a.MathUtils.degToRad(20),0,0),se=e=>{const o={[q.STORE_SNAPSHOT]:(0,n.LI)((()=>y())),[q.RESTORE_SNAPSHOT]:(0,n.LI)((()=>M())),[q.RESET]:(0,n.LI)((()=>N()))};var r;r=o,(0,n.M4)(z.O.SCHEMA.SIMULATION,r,{order:z.O.ORDER.SIMULATION});const c=(0,i.useContext)(p),I=(0,s.dv)(),{camera:E}=(0,t.A)(),u=(0,i.useRef)(null),T=(0,i.useRef)(null),L=(0,i.useRef)(null),d=(0,i.useRef)(null),[h,x]=(0,i.useState)(0),N=(0,i.useCallback)((()=>{console.info("Rapier: resetting..."),m.LEFT.POSITION.setX(-O.EXTREMITY*(Math.random()+.5)),m.MIDDLE.POSITION.setX(O.CENTER*(2*Math.random()-1)),m.RIGHT.POSITION.setX(O.EXTREMITY*(Math.random()+.5)),re(u,m.LEFT.POSITION),re(T,m.MIDDLE.POSITION),re(L,m.RIGHT.POSITION)}),[]),M=(0,i.useCallback)((()=>{console.info("Rapier: restoring snapshot...");const e=I.rapier.World.restoreSnapshot(d.current);I.setWorld(e)}),[I]),y=(0,i.useCallback)((()=>{console.info("Rapier: taking snapshot...");const e=I.world.takeSnapshot();d.current=e}),[I]);return(0,i.useEffect)((()=>{E.position.set(...$.POSITION.toArray()),E.lookAt(...$.TARGET.toArray())}),[E]),(0,i.useEffect)((()=>{console.info("Rapier: counter",h),3<=h&&(setTimeout((()=>{console.info("Rapier: calling reset."),N()}),2e3),x(0))}),[h,N]),(0,i.useEffect)((()=>{setTimeout((()=>{y()}),250)}),[y]),(0,t.C)(((e,o)=>{c.add(Math.floor(2*Math.random()))})),(0,R.jsxs)("group",{name:"Pinball Machine Game",...e,children:[(0,R.jsxs)("group",{name:"Tilt",rotation:te,children:[(0,R.jsxs)("group",{name:"Cabinet",children:[(0,R.jsx)(Y,{}),(0,R.jsx)(F,{}),(0,R.jsx)(s.ib,{type:"fixed",children:(0,R.jsx)(s.jc,{args:[4.7,.125,.125],collisionGroups:(0,s.bI)(l.SENSOR,[l.BALL]),onCollisionExit:()=>{console.info("Rapier: collision detected!"),x((e=>e+1))},position:new a.Vector3(0,.125,2),sensor:!0})})]}),(0,R.jsx)("group",{name:"Attractor",children:(0,R.jsx)(A,{})}),(0,R.jsxs)("group",{name:"Bumpers",children:[(0,R.jsx)(P,{position:new a.Vector3(0,0,-2)}),(0,R.jsx)(P,{position:new a.Vector3(-3,0,-5)}),(0,R.jsx)(P,{position:new a.Vector3(3,0,-5)})]}),(0,R.jsx)("group",{name:"Flippers",children:(0,R.jsxs)("group",{position:new a.Vector3(0,0,0),children:[(0,R.jsx)(_,{orientation:U.LEFT.ORIENTATION,position:U.LEFT.POSITION}),(0,R.jsx)(_,{orientation:U.RIGHT.ORIENTATION,position:U.RIGHT.POSITION})]})}),(0,R.jsxs)("group",{name:"Plunger Assembly",position:[4.7,0,2],children:[(0,R.jsx)(A,{position:new a.Vector3(0,0,0)}),(0,R.jsx)(S,{color:"cyan",position:new a.Vector3(0,3,-5)}),(0,R.jsx)(Q,{position:new a.Vector3(0,0,0)})]})]}),(0,R.jsxs)("group",{name:"Balls",children:[(0,R.jsx)(S,{color:m.LEFT.COLOR,position:m.LEFT.POSITION,ref:u}),(0,R.jsx)(S,{color:m.MIDDLE.COLOR,position:m.MIDDLE.POSITION,ref:T}),(0,R.jsx)(S,{color:m.RIGHT.COLOR,position:m.RIGHT.POSITION,ref:L})]})]})};var ne=r(7066),ie=r(5819),ae=r(1724),le=r(7862),ce=r(9363),pe=r(4662),Ie=r(3280);const Ee=e=>{let{children:o}=e;const r=(0,pe.p)(),t=(0,Ie.p)();return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(ie.Xz,{camera:void 0,flat:r.flat,frameloop:r.frameloop,linear:r.linear,orthographic:!1,shadows:r.shadows,children:(0,R.jsxs)(i.Suspense,{children:[(0,R.jsx)(ae.Z,{}),(0,R.jsx)(le.u,{}),(0,R.jsx)(G.c,{map:ce.n.CONFIG_PINBALL_MACHINE,children:(0,R.jsx)(s.wI,{colliders:void 0,debug:t.showDebug,gravity:[t.gravity.x,t.gravity.y,t.gravity.z],paused:t.paused,timeStep:"vary",updatePriority:void 0,children:o})})]})}),(0,R.jsx)(n.Zf,{collapsed:!1,fill:!1,flat:!1,hidden:!1,oneLineLabels:!0,titleBar:!0}),(0,R.jsx)(ne.a,{})]})},Re=e=>(0,R.jsx)(Ee,{children:(0,R.jsx)(se,{...e})})}}]);